!function(){"use strict";angular.module("ConnectionFactory.factory",[]).factory("ConnectionManager",["$window","$q",function(a,b){var c;return c=function(b,c,d,e){var f=a.indexedDB.open(b.DbName,b.DbVersion);f.onerror=function(a){alert("Exited with error: "+a.target.error.message)},f.onsuccess=function(a){b.Db=a.target.result,e(b,c)},f.onupgradeneeded=function(a){var f;b.Db=a.target.result;var g=c.autoIncrement?{autoIncrement:!0}:{keyPath:c.keyPath};c.createdObjectStore=b.Db.createObjectStore(c.name,g);for(f in d)d.hasOwnProperty(f)&&c.createdObjectStore.createIndex(d[f].name,d[f].name,{unique:d[f].unique});c.createdObjectStore.oncomplete=function(){e&&e(b,c),c.createdObjectStore.oncomplete=function(){e&&e(b,c)}}}},{openConnection:function(a,b,d,e){c(a,b,d,e)},openConnectionWithPromise:function(c,d,e){var f,g;return f=b.defer(),g=function(b,c,d){var e=a.indexedDB.open(b.DbName,b.DbVersion);e.onerror=function(a){f.reject(a.target.error.message)},e.onupgradeneeded=function(a){var e;b.Db=a.target.result;var g=c.autoIncrement?{autoIncrement:!0}:{keyPath:c.keyPath};c.createdObjectStore=b.Db.createObjectStore(c.name,g);for(e in d)d.hasOwnProperty(e)&&c.createdObjectStore.createIndex(d[e].name,d[e].name,{unique:d[e].unique});c.createdObjectStore.oncomplete=function(){f.resolve(b.Db)}},e.onsuccess=function(a){f.resolve(a.target.result)}},g(c,d,e),f.promise},getDatabaseVersion:function(c){var d,e;return d=b.defer(),e=a.indexedDB.open(c.DbName,c.DbVersion),d.resolve(e.result.version),d.promise}}}])}(),function(){"use strict";angular.module("DatabaseObject.value",[]).value("DatabaseObject",{DbName:"",DbVersion:"",Db:{}})}(),function(){"use strict";angular.module("IndecesObject.value",[]).value("IndecesObject",[{name:"",params:{unique:!1}}])}(),function(){"use strict";angular.module("ObjectStore.value",[]).value("ObjectStore",{name:"",keyPath:"",autoIncrement:!1,createdObjectStore:null})}(),function(){"use strict";angular.module("TransactionFactory.factory",[]).factory("TransactionFactory",["$q","ConnectionManager",function(a,b){var c,d;return c=function(a,b){a.Db.transaction([b]).objectStore(b).clear()},d=function(a){var c,d,e;for(e=!1,c=b.getObjectStoreNames(),d=0;c>d;d++)if(a===c[1]){e=!0;break}return e},{insert:function(a,c,d,e){var f,g;f=function(a,b){var c,d;for(c in e)e.hasOwnProperty(c)&&(d=a.Db.transaction([b.name],"readwrite"),e.hasOwnProperty(c)&&(null!==b.createdObjectStore?d.add(e[c]):(g=d.objectStore(b.name),g.add(e[c]))))},b.openConnection(a,c,d,f)},insertWithPromise:function(c,d,e,f){var g,h;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){var b,c;for(b in f)f.hasOwnProperty(b)&&(c=a.transaction([d.name],"readwrite"),f.hasOwnProperty(b)&&(null!==d.createdObjectStore&&null!==d.createdObjectStore&&(c=a.transaction([d.name],"readwrite")),h=c.objectStore(d.name),h.add(f[b]))),g.resolve(!0)}),g.promise},"delete":function(a,c,d,e){var f;f=function(a,b){a.Db.transaction([b.name],"readwrite").objectStore(b.name)["delete"](e)},b.openConnection(a,c,d,f)},deleteWithPromise:function(c,d,e,f){var g;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name],"readwrite").objectStore(d.name)["delete"](f),g.resolve(!0)}),g.promise},getByKey:function(a,c,d,e,f){var g;g=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).get(e).onsuccess=function(a){f&&f(a.target.result)}},b.openConnection(a,c,d,g)},getByKeyWithPromise:function(c,d,e,f){var g;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).get(f).onsuccess=function(a){g.resolve(a.target.result)}}),g.promise},getByIndex:function(a,c,d,e,f,g){var h;h=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).index(f).get(e).onsuccess=function(a){void 0!==g&&g(a.target.result)}},b.openConnection(a,c,d,h)},getByIndexWithPromise:function(c,d,e,f,g){var h;return h=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).index(g).get(f).onsuccess=function(a){h.resolve(a.target.result)}}),h.promise},getByValue:function(a,c,d,e,f,g){var h,i;i=[],h=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).openCursor().onsuccess=function(a){var b=a.target.result;b?b.value[f].toString().indexOf(e)>-1?(i.push(b.value),b["continue"]()):b["continue"]():void 0!==g&&g(i)}},b.openConnection(a,c,d,h)},getByValueWithPromise:function(c,d,e,f,g){var h,i;return h=a.defer(),i=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;b?b.value[g].toString().indexOf(f)>-1?(i.push(b.value),b["continue"]()):b["continue"]():h.resolve(i)}}),h.promise},updateDataByKey:function(a,c,d,e){var f;f=function(a,b){a.Db.transaction([b.name],"readwrite").objectStore(b.name).put(e)},b.openConnection(a,c,d,f)},updateDataByKeyWithPromise:function(c,d,e,f){var g;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name],"readwrite").objectStore(d.name).put(f),g.resolve()}),g.promise},selectAll:function(a,c,d,e){var f;f=[],b.openConnectionWithPromise(a,c,d).then(function(a){a.transaction([c.name]).objectStore(c.name).openCursor().onsuccess=function(a){var b=a.target.result;b?(f.push(b.value),b["continue"]()):void 0!==e&&e(f)}})},selectAllWithPromise:function(c,d,e){var f,g;return f=a.defer(),g=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;b?(g.push(b.value),b["continue"]()):f.resolve(g)}}),f.promise},selectByPosition:function(a,c,d,e,f,g){var h,i,j;i=0,j=[],h=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).openCursor().onsuccess=function(a){var b=a.target.result;b?e>i?(i++,b.advance(e)):i>=e&&f>=i?(j.push(b.value),i++,b["continue"]()):b["continue"]():void 0!==g&&g(j)}},b.openConnection(a,c,d,h)},selectByPositionWithPromise:function(c,d,e,f,g){var h,i,j;return h=a.defer(),i=0,j=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;b?f>i?(i++,b.advance(f)):i>=f&&g>=i?(j.push(b.value),i++,b["continue"]()):b["continue"]():h.resolve(j)}}),h.promise},freeTextSearch:function(a,c,d,e,f){var g,h;h=[],g=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).openCursor().onsuccess=function(a){var b=a.target.result;if(b){var c;for(c in b.value)if(b.value.hasOwnProperty(c)&&b.value[c].toString().indexOf(e)>-1){h.push(b.value);break}b["continue"]()}else void 0!==f&&f(h)}},b.openConnection(a,c,d,g)},freeTextSearchWithPromise:function(c,d,e,f){var g,h;return g=a.defer(),h=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;if(b){var c;for(c in b.value)if(b.value.hasOwnProperty(c)&&b.value[c].toString().indexOf(f)>-1){h.push(b.value);break}b["continue"]()}else g.resolve(h)}}),g.promise},getKeyPath:function(a,c,d,e){var f;f=function(a,b){var c=a.Db.transaction([b.name]).objectStore(b.name).keyPath;void 0!==e&&e(c)},b.openConnection(a,c,d,f)},getKeyPathWithPromise:function(c,d,e){var f,g;return f=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){g=a.transaction([d.name]).objectStore(d.name).keyPath,f.resolve(g)}),f.promise},getIndeceNames:function(a,c,d,e){var f;f=function(a,b){var c;c=[],c=a.Db.transaction([b.name]).objectStore(b.name).indexNames,void 0!==e&&e(c)},b.openConnection(a,c,d,f)},getIndeceNamesWithPromise:function(c,d,e){var f;return f=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){var b;b=[],b=a.transaction([d.name]).objectStore(d.name).indexNames,f.resolve(b)}),f.promise},clearObjectStores:function(a,d,e){var f,g;g=[],f=function(a,b){var d;g=a.objectStoreNames;for(d in g)g.hasOwnProperty(b)&&c(a,g[d])},b.openConnection(a,d,e,f)},deleteAll:function(a,d,e){var f;f=function(a,b){c(a,b.name)},b.openConnection(a,d,e,f)}}}])}(),function(){"use strict";angular.module("ConnectionFactory.factory",[]).factory("ConnectionManager",["$window","$q",function(a,b){var c;return c=function(b,c,d,e){var f=a.indexedDB.open(b.DbName,b.DbVersion);f.onerror=function(a){alert("Exited with error: "+a.target.error.message)},f.onsuccess=function(a){b.Db=a.target.result,e(b,c)},f.onupgradeneeded=function(a){var f;b.Db=a.target.result;var g=c.autoIncrement?{autoIncrement:!0}:{keyPath:c.keyPath};c.createdObjectStore=b.Db.createObjectStore(c.name,g);for(f in d)d.hasOwnProperty(f)&&c.createdObjectStore.createIndex(d[f].name,d[f].name,{unique:d[f].unique});c.createdObjectStore.oncomplete=function(){e&&e(b,c),c.createdObjectStore.oncomplete=function(){e&&e(b,c)}}}},{openConnection:function(a,b,d,e){c(a,b,d,e)},openConnectionWithPromise:function(c,d,e){var f,g;return f=b.defer(),g=function(b,c,d){var e=a.indexedDB.open(b.DbName,b.DbVersion);e.onerror=function(a){f.reject(a.target.error.message)},e.onupgradeneeded=function(a){var e;b.Db=a.target.result;var g=c.autoIncrement?{autoIncrement:!0}:{keyPath:c.keyPath};c.createdObjectStore=b.Db.createObjectStore(c.name,g);for(e in d)d.hasOwnProperty(e)&&c.createdObjectStore.createIndex(d[e].name,d[e].name,{unique:d[e].unique});c.createdObjectStore.oncomplete=function(){f.resolve(b.Db)}},e.onsuccess=function(a){f.resolve(a.target.result)}},g(c,d,e),f.promise},getDatabaseVersion:function(c){var d,e;return d=b.defer(),e=a.indexedDB.open(c.DbName,c.DbVersion),d.resolve(e.result.version),d.promise}}}])}(),function(){"use strict";angular.module("DatabaseObject.value",[]).value("DatabaseObject",{DbName:"",DbVersion:"",Db:{}})}(),function(){"use strict";angular.module("IndecesObject.value",[]).value("IndecesObject",[{name:"",params:{unique:!1}}])}(),function(){"use strict";angular.module("ObjectStore.value",[]).value("ObjectStore",{name:"",keyPath:"",autoIncrement:!1,createdObjectStore:null})}(),function(){"use strict";angular.module("TransactionFactory.factory",[]).factory("TransactionFactory",["$q","ConnectionManager",function(a,b){var c,d;return c=function(a,b){a.Db.transaction([b]).objectStore(b).clear()},d=function(a){var c,d,e;for(e=!1,c=b.getObjectStoreNames(),d=0;c>d;d++)if(a===c[1]){e=!0;break}return e},{insert:function(a,c,d,e){var f,g;f=function(a,b){var c,d;for(c in e)e.hasOwnProperty(c)&&(d=a.Db.transaction([b.name],"readwrite"),e.hasOwnProperty(c)&&(null!==b.createdObjectStore?d.add(e[c]):(g=d.objectStore(b.name),g.add(e[c]))))},b.openConnection(a,c,d,f)},insertWithPromise:function(c,d,e,f){var g,h;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){var b,c;for(b in f)f.hasOwnProperty(b)&&(c=a.transaction([d.name],"readwrite"),f.hasOwnProperty(b)&&(null!==d.createdObjectStore&&null!==d.createdObjectStore&&(c=a.transaction([d.name],"readwrite")),h=c.objectStore(d.name),h.add(f[b]))),g.resolve(!0)}),g.promise},"delete":function(a,c,d,e){var f;f=function(a,b){a.Db.transaction([b.name],"readwrite").objectStore(b.name)["delete"](e)},b.openConnection(a,c,d,f)},deleteWithPromise:function(c,d,e,f){var g;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name],"readwrite").objectStore(d.name)["delete"](f),g.resolve(!0)}),g.promise},getByKey:function(a,c,d,e,f){var g;g=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).get(e).onsuccess=function(a){f&&f(a.target.result)}},b.openConnection(a,c,d,g)},getByKeyWithPromise:function(c,d,e,f){var g;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).get(f).onsuccess=function(a){g.resolve(a.target.result)}}),g.promise},getByIndex:function(a,c,d,e,f,g){var h;h=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).index(f).get(e).onsuccess=function(a){void 0!==g&&g(a.target.result)}},b.openConnection(a,c,d,h)},getByIndexWithPromise:function(c,d,e,f,g){var h;return h=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).index(g).get(f).onsuccess=function(a){h.resolve(a.target.result)}}),h.promise},getByValue:function(a,c,d,e,f,g){var h,i;i=[],h=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).openCursor().onsuccess=function(a){var b=a.target.result;b?b.value[f].toString().indexOf(e)>-1?(i.push(b.value),b["continue"]()):b["continue"]():void 0!==g&&g(i)}},b.openConnection(a,c,d,h)},getByValueWithPromise:function(c,d,e,f,g){var h,i;return h=a.defer(),i=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;b?b.value[g].toString().indexOf(f)>-1?(i.push(b.value),b["continue"]()):b["continue"]():h.resolve(i)}}),h.promise},updateDataByKey:function(a,c,d,e){var f;f=function(a,b){a.Db.transaction([b.name],"readwrite").objectStore(b.name).put(e)},b.openConnection(a,c,d,f)},updateDataByKeyWithPromise:function(c,d,e,f){var g;return g=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name],"readwrite").objectStore(d.name).put(f),g.resolve()}),g.promise},selectAll:function(a,c,d,e){var f;f=[],b.openConnectionWithPromise(a,c,d).then(function(a){a.transaction([c.name]).objectStore(c.name).openCursor().onsuccess=function(a){var b=a.target.result;b?(f.push(b.value),b["continue"]()):void 0!==e&&e(f)}})},selectAllWithPromise:function(c,d,e){var f,g;return f=a.defer(),g=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;b?(g.push(b.value),b["continue"]()):f.resolve(g)}}),f.promise},selectByPosition:function(a,c,d,e,f,g){var h,i,j;i=0,j=[],h=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).openCursor().onsuccess=function(a){var b=a.target.result;b?e>i?(i++,b.advance(e)):i>=e&&f>=i?(j.push(b.value),i++,b["continue"]()):b["continue"]():void 0!==g&&g(j)}},b.openConnection(a,c,d,h)},selectByPositionWithPromise:function(c,d,e,f,g){var h,i,j;return h=a.defer(),i=0,j=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;b?f>i?(i++,b.advance(f)):i>=f&&g>=i?(j.push(b.value),i++,b["continue"]()):b["continue"]():h.resolve(j)}}),h.promise},freeTextSearch:function(a,c,d,e,f){var g,h;h=[],g=function(a,b){a.Db.transaction([b.name]).objectStore(b.name).openCursor().onsuccess=function(a){var b=a.target.result;if(b){var c;for(c in b.value)if(b.value.hasOwnProperty(c)&&b.value[c].toString().indexOf(e)>-1){h.push(b.value);break}b["continue"]()}else void 0!==f&&f(h)}},b.openConnection(a,c,d,g)},freeTextSearchWithPromise:function(c,d,e,f){var g,h;return g=a.defer(),h=[],b.openConnectionWithPromise(c,d,e).then(function(a){a.transaction([d.name]).objectStore(d.name).openCursor().onsuccess=function(a){var b=a.target.result;if(b){var c;for(c in b.value)if(b.value.hasOwnProperty(c)&&b.value[c].toString().indexOf(f)>-1){h.push(b.value);break}b["continue"]()}else g.resolve(h)}}),g.promise},getKeyPath:function(a,c,d,e){var f;f=function(a,b){var c=a.Db.transaction([b.name]).objectStore(b.name).keyPath;void 0!==e&&e(c)},b.openConnection(a,c,d,f)},getKeyPathWithPromise:function(c,d,e){var f,g;return f=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){g=a.transaction([d.name]).objectStore(d.name).keyPath,f.resolve(g)}),f.promise},getIndeceNames:function(a,c,d,e){var f;f=function(a,b){var c;c=[],c=a.Db.transaction([b.name]).objectStore(b.name).indexNames,void 0!==e&&e(c)},b.openConnection(a,c,d,f)},getIndeceNamesWithPromise:function(c,d,e){var f;return f=a.defer(),b.openConnectionWithPromise(c,d,e).then(function(a){var b;b=[],b=a.transaction([d.name]).objectStore(d.name).indexNames,f.resolve(b)}),f.promise},clearObjectStores:function(a,d,e){var f,g;g=[],f=function(a,b){var d;g=a.objectStoreNames;for(d in g)g.hasOwnProperty(b)&&c(a,g[d])},b.openConnection(a,d,e,f)},deleteAll:function(a,d,e){var f;f=function(a,b){c(a,b.name)},b.openConnection(a,d,e,f)}}}])}(),function(){"use strict";angular.module("IndexedDb.Utils",["ConnectionFactory.factory","DatabaseObject.value","ObjectStore.value","IndecesObject.value","TransactionFactory.factory","Helper.factory"])}(),function(){"use strict";angular.module("Helper.factory",[]).factory("HelperFactory",[function(){return{getFieldType:function(a){return typeof a}}}])}(),function(){"use strict";angular.module("IndexedDb.Utils",["ConnectionFactory.factory","DatabaseObject.value","ObjectStore.value","IndecesObject.value","TransactionFactory.factory","Helper.factory"])}(),function(){"use strict";angular.module("Helper.factory",[]).factory("HelperFactory",[function(){return{getFieldType:function(a){return typeof a}}}])}();
